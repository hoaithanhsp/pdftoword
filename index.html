<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF to Word Converter - Chuy·ªÉn ƒë·ªïi PDF sang Word mi·ªÖn ph√≠</title>
    <meta name="description"
        content="C√¥ng c·ª• chuy·ªÉn ƒë·ªïi PDF sang Word tr·ª±c tuy·∫øn mi·ªÖn ph√≠. H·ªó tr·ª£ OCR ti·∫øng Vi·ªát, AI x·ª≠ l√Ω c√¥ng th·ª©c to√°n, xu·∫•t file .docx ch·∫•t l∆∞·ª£ng cao.">

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap"
        rel="stylesheet">
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">
    <!-- KaTeX CSS -->
    <link href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" rel="stylesheet">
    <!-- App CSS -->
    <link href="css/style.css" rel="stylesheet">
</head>

<body>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
        <div class="loading-text">
            ƒêang x·ª≠ l√Ω t√†i li·ªáu...<br>
            <small>Qu√° tr√¨nh n√†y c√≥ th·ªÉ m·∫•t 30-60 gi√¢y</small>
        </div>
    </div>

    <!-- ========================================
         API KEY MODAL
         ======================================== -->
    <div class="modal-overlay" id="apiKeyModal">
        <div class="modal-content">
            <div class="modal-header">
                <span class="modal-icon">üîë</span>
                <h2>Thi·∫øt l·∫≠p API Key</h2>
                <p>Nh·∫≠p Gemini API Key ƒë·ªÉ s·ª≠ d·ª•ng t√≠nh nƒÉng AI x·ª≠ l√Ω c√¥ng th·ª©c to√°n</p>
            </div>

            <div class="modal-body">
                <!-- API Key Input -->
                <div class="input-group">
                    <label for="apiKeyInput"><i class="fas fa-key"></i> Gemini API Key</label>
                    <div class="input-with-btn">
                        <input type="password" id="apiKeyInput" placeholder="AIzaSy..." autocomplete="off">
                        <button class="btn-icon" id="toggleKeyVisibility" title="Hi·ªÉn th·ªã/·∫®n key">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                    <div class="input-hint">
                        <a href="https://aistudio.google.com/apikey" target="_blank" rel="noopener">
                            <i class="fas fa-external-link-alt"></i> L·∫•y API key mi·ªÖn ph√≠ t·∫°i Google AI Studio
                        </a>
                    </div>
                </div>

                <!-- Model Selection -->
                <div class="model-selector">
                    <label><i class="fas fa-robot"></i> Ch·ªçn Model AI</label>
                    <div class="model-cards" id="modelCards">
                        <!-- Rendered by JS -->
                    </div>
                </div>

                <!-- Validation Status -->
                <div class="validation-status hidden" id="validationStatus">
                    <i class="fas fa-spinner fa-spin"></i> <span>ƒêang ki·ªÉm tra...</span>
                </div>
            </div>

            <div class="modal-footer">
                <button class="btn btn-outline btn-sm" id="skipApiKeyBtn">
                    <i class="fas fa-forward"></i> B·ªè qua (kh√¥ng d√πng AI)
                </button>
                <button class="btn btn-primary btn-sm" id="saveApiKeyBtn">
                    <i class="fas fa-check"></i> L∆∞u & Ti·∫øp t·ª•c
                </button>
            </div>
        </div>
    </div>

    <!-- ========================================
         MAIN APP
         ======================================== -->
    <div class="app-container">

        <!-- Header -->
        <header class="header fade-in">
            <div class="header-content">
                <!-- Settings Button (top-right of header) -->
                <button class="header-settings-btn" id="openSettingsBtn" title="C√†i ƒë·∫∑t API Key">
                    <i class="fas fa-cog"></i>
                    <span class="settings-label" id="settingsLabel">C√†i ƒë·∫∑t API Key</span>
                </button>

                <span class="header-icon">üìÑ‚û°Ô∏èüìù</span>
                <h1>PDF to Word Converter</h1>
                <p>Chuy·ªÉn ƒë·ªïi PDF sang Word (.docx) ‚Äî AI x·ª≠ l√Ω c√¥ng th·ª©c to√°n h·ªçc</p>
                <p style="font-size: 0.85rem; margin-top: 8px; opacity: 0.9; font-weight: 600;">
                    üë®‚Äçüè´ Ph√°t tri·ªÉn b·ªüi th·∫ßy Tr·∫ßn Ho√†i Thanh - 0348296773
                </p>

                <!-- API Key Warning -->
                <div class="api-warning hidden" id="apiWarning">
                    <i class="fas fa-exclamation-triangle"></i>
                    <span>Ch∆∞a c√≥ API key ‚Äî <a href="#" id="openModalLink">Nh·∫≠p key ƒë·ªÉ d√πng AI</a></span>
                </div>
            </div>
        </header>

        <!-- Features -->
        <div class="features-grid fade-in">
            <div class="feature-card stagger-1">
                <span class="icon">‚ö°</span>
                <h3>X·ª≠ l√Ω nhanh</h3>
                <p>Tr√≠ch xu·∫•t text t·ª©c th√¨ t·ª´ PDF c√≥ s·∫µn text</p>
            </div>
            <div class="feature-card stagger-2">
                <span class="icon">üßÆ</span>
                <h3>AI To√°n h·ªçc</h3>
                <p>Gemini AI s·ª≠a l·ªói & render c√¥ng th·ª©c LaTeX</p>
            </div>
            <div class="feature-card stagger-3">
                <span class="icon">üì¶</span>
                <h3>Xu·∫•t Word</h3>
                <p>T·∫°o file .docx gi·ªØ c·∫•u tr√∫c ƒëo·∫°n vƒÉn</p>
            </div>
        </div>

        <!-- Upload Card -->
        <div class="card fade-in">
            <div class="card-header">
                <div class="icon"><i class="fas fa-cloud-upload-alt"></i></div>
                <h2>T·∫£i l√™n file PDF</h2>
            </div>

            <!-- Upload Zone -->
            <div class="upload-zone" id="uploadZone">
                <i class="fas fa-cloud-upload-alt upload-icon"></i>
                <div class="upload-text">K√©o th·∫£ file PDF v√†o ƒë√¢y</div>
                <div class="upload-subtext">ho·∫∑c nh·∫•n ƒë·ªÉ ch·ªçn file ‚Ä¢ H·ªó tr·ª£ PDF (t·ªëi ƒëa 50MB)</div>
            </div>
            <input type="file" id="fileInput" accept=".pdf,application/pdf" multiple style="display:none">

            <!-- File Preview -->
            <div id="filePreviewContainer"></div>

            <!-- Options -->
            <div class="options-row">
                <div class="option-group">
                    <label><i class="fas fa-language"></i> Ng√¥n ng·ªØ OCR</label>
                    <select id="languageSelect">
                        <option value="vie+eng">Ti·∫øng Vi·ªát + Anh</option>
                        <option value="vie">Ti·∫øng Vi·ªát</option>
                        <option value="eng">Ti·∫øng Anh</option>
                        <option value="jpn">Ti·∫øng Nh·∫≠t</option>
                        <option value="kor">Ti·∫øng H√†n</option>
                        <option value="chi_sim">Ti·∫øng Trung (Gi·∫£n th·ªÉ)</option>
                    </select>
                </div>
                <div class="option-group">
                    <div class="toggle-option" style="margin-top: 22px;">
                        <label class="toggle-switch">
                            <input type="checkbox" id="ocrToggle">
                            <span class="toggle-slider"></span>
                        </label>
                        <span class="toggle-label">B·∫Øt bu·ªôc OCR</span>
                    </div>
                </div>
                <div class="option-group">
                    <div class="toggle-option" style="margin-top: 22px;">
                        <label class="toggle-switch">
                            <input type="checkbox" id="aiMathToggle" checked>
                            <span class="toggle-slider"></span>
                        </label>
                        <span class="toggle-label">ü§ñ AI s·ª≠a c√¥ng th·ª©c</span>
                    </div>
                </div>
            </div>

            <div class="options-row">
                <div class="option-group">
                    <div class="toggle-option">
                        <label class="toggle-switch">
                            <input type="checkbox" id="batchToggle">
                            <span class="toggle-slider"></span>
                        </label>
                        <span class="toggle-label">Ch·∫ø ƒë·ªô batch</span>
                    </div>
                </div>
            </div>

            <!-- Process Button -->
            <button class="btn btn-primary btn-full" id="processBtn" disabled>
                <i class="fas fa-magic"></i> Ch·ªçn file PDF tr∆∞·ªõc
            </button>

            <!-- Progress -->
            <div class="progress-container" id="progressContainer">
                <div class="progress-header">
                    <span class="progress-label">ƒêang x·ª≠ l√Ω...</span>
                    <span class="progress-percent" id="progressPercent">0%</span>
                </div>
                <div class="progress-bar-track">
                    <div class="progress-bar-fill" id="progressFill"></div>
                </div>
                <div class="progress-status" id="progressStatus">Chu·∫©n b·ªã...</div>
            </div>

            <!-- Alert Container -->
            <div id="alertContainer"></div>
        </div>

        <!-- Results Card -->
        <div class="card fade-in results-section" id="resultsSection">
            <div class="card-header">
                <div class="icon"><i class="fas fa-file-alt"></i></div>
                <h2>K·∫øt qu·∫£ chuy·ªÉn ƒë·ªïi</h2>
            </div>

            <!-- Stats -->
            <div class="stats-grid" id="statsGrid">
                <div class="stat-card">
                    <div class="stat-value" id="pageCount">0</div>
                    <div class="stat-label">S·ªë trang</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="confidence">0%</div>
                    <div class="stat-label">ƒê·ªô ch√≠nh x√°c</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="processingTime">0s</div>
                    <div class="stat-label">Th·ªùi gian</div>
                </div>
            </div>

            <!-- View Toggle -->
            <div class="view-toggle" id="viewToggle" style="display:none;">
                <button class="view-btn active" data-view="rendered" id="viewRenderedBtn">
                    <i class="fas fa-eye"></i> Xem render
                </button>
                <button class="view-btn" data-view="raw" id="viewRawBtn">
                    <i class="fas fa-code"></i> Text g·ªëc
                </button>
            </div>

            <!-- Action Buttons -->
            <div class="btn-group" style="margin-bottom: 20px;">
                <button class="btn btn-outline btn-sm" id="copyBtn">
                    <i class="fas fa-copy"></i> Sao ch√©p
                </button>
                <button class="btn btn-outline btn-sm" id="downloadTxtBtn">
                    <i class="fas fa-download"></i> T·∫£i TXT
                </button>
                <button class="btn btn-primary btn-sm" id="exportWordBtn">
                    <i class="fas fa-file-word"></i> Xu·∫•t Word (.docx)
                </button>
            </div>

            <!-- Rendered Result (with KaTeX) -->
            <div class="result-rendered" id="resultsRendered" style="display:none;"></div>

            <!-- Raw Result Text -->
            <div class="result-container" id="resultsText">
                <div class="result-placeholder">
                    <i class="fas fa-file-alt"></i>
                    <p>K·∫øt qu·∫£ s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y...</p>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="footer fade-in">
            <p>üõ°Ô∏è M·ªçi x·ª≠ l√Ω di·ªÖn ra tr√™n tr√¨nh duy·ªát ‚Äî D·ªØ li·ªáu kh√¥ng ƒë∆∞·ª£c upload l√™n server</p>
            <p style="margin-top: 8px; font-size: 0.78rem; color: #9ca3af;">
                Powered by PDF.js ‚Ä¢ Tesseract.js ‚Ä¢ Gemini AI ‚Ä¢ KaTeX ‚Ä¢ docx
            </p>
        </footer>

    </div>

    <!-- ========================================
         LIBRARIES (CDN)
         ======================================== -->

    <!-- PDF.js -->
    <script>
        (async () => {
            const pdfjsModule = await import('https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.9.155/pdf.min.mjs');
            window.pdfjsLib = pdfjsModule;
            pdfjsModule.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.9.155/pdf.worker.min.mjs';
            console.log('‚úÖ PDF.js loaded');
        })();
    </script>

    <!-- Tesseract.js -->
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>

    <!-- docx library -->
    <script src="https://cdn.jsdelivr.net/npm/docx@9.0.2/build/index.umd.min.js"></script>

    <!-- FileSaver.js -->
    <script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"></script>

    <!-- KaTeX JS + Auto-render -->
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js"></script>

    <!-- App Scripts -->
    <script src="js/gemini-service.js"></script>
    <script src="js/pdf-processor.js"></script>
    <script src="js/word-exporter.js"></script>
    <script src="js/app.js"></script>

</body>

</html>